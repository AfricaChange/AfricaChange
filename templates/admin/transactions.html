{% extends "base_admin.html" %}
{% include "admin/components/admin_modals.html" %}
{% block content %}

<h1 class="text-2xl font-bold mb-4">ðŸ’³ Transactions LIVE</h1>

<!-- Filtres -->
<form method="get" class="flex gap-3 mb-6 text-sm">
  <select name="status" class="border rounded px-2 py-1">
    <option value="">Statut</option>
    <option value="en_attente">En attente</option>
    <option value="valide">ValidÃ©e</option>
    <option value="bloque">BloquÃ©e</option>
    <option value="echoue">Ã‰chouÃ©e</option>
  </select>

  <select name="provider" class="border rounded px-2 py-1">
    <option value="">Fournisseur</option>
    <option>Orange Money</option>
    <option>Wave</option>
    <option>Simulation</option>
    <option>admin</option>
  </select>

  <input name="q" placeholder="RÃ©fÃ©rence"
         class="border rounded px-2 py-1">

  <button class="bg-blue-600 text-white px-4 py-1 rounded">
    Filtrer
  </button>
</form>

<!-- Table -->
<table class="w-full bg-white shadow rounded text-sm">
  <thead class="bg-gray-100">
    <tr>
      <th class="p-2">Date</th>
      <th class="p-2">RÃ©fÃ©rence</th>
      <th class="p-2">Montant</th>
      <th class="p-2">Statut</th>
      <th class="p-2">Provider</th>
      <th class="p-2 text-center">Actions</th>
    </tr>
  </thead>
  <tbody>
    {% for tx in transactions %}
    <tr class="border-t hover:bg-gray-50">
        <td class="p-2 text-center space-x-2">

            {% if tx.statut == "en_attente" %}
                <button onclick="openAdminModal('validate','{{ tx.reference }}')"
                    class="text-green-600 hover:text-green-800"
                    title="Valider">
                    âœ”
                </button>

                <button onclick="openAdminModal('block','{{ tx.reference }}')"
                    class="text-red-600 hover:text-red-800"
                    title="Bloquer">
                    â›”
                </button>

            {% elif tx.statut == "valide" %}
                <button onclick="openAdminModal('refund','{{ tx.reference }}')"
                    class="text-yellow-600 hover:text-yellow-800"
                    title="Rembourser">
                    ðŸ’¸
                </button>

            {% else %}
                <span class="text-gray-400 text-xs">â€”</span>
            {% endif %}

        </td>
    </tr>
    {% endfor %}
  </tbody>
</table>

{% endblock %}
