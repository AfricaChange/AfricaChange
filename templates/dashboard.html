{% extends "base.html" %}
{% block content %}

<div class="max-w-6xl mx-auto space-y-8">

  <!-- ======================================================
       ðŸ‘‹ HEADER UTILISATEUR
  ====================================================== -->
  <div class="flex flex-col md:flex-row md:items-center md:justify-between gap-4">
    <div>
      <h1 class="text-2xl font-bold text-gray-900">
        Bonjour {{ user.prenom }} ðŸ‘‹
      </h1>
      <p class="text-sm text-gray-500">
        Bienvenue sur votre espace AfricaChange
      </p>
    </div>

    <div class="flex gap-3">
      <a href="{{ url_for('convert.convertir') }}"
         class="bg-indigo-600 text-white px-4 py-2 rounded-lg text-sm font-semibold hover:bg-indigo-700">
        Nouvelle conversion
      </a>

      <a href="{{ url_for('auth.modifier_profil') }}"
         class="bg-gray-100 px-4 py-2 rounded-lg text-sm hover:bg-gray-200">
        Profil
      </a>
    </div>
  </div>

  <!-- ======================================================
       ðŸ’³ CARTES INFOS (FINTECH STYLE)
  ====================================================== -->
  <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4">

    <div class="bg-white p-5 rounded-xl shadow">
      <p class="text-sm text-gray-500">Nom</p>
      <p class="font-semibold">{{ user.prenom }} {{ user.nom }}</p>
    </div>

    <div class="bg-white p-5 rounded-xl shadow">
      <p class="text-sm text-gray-500">TÃ©lÃ©phone</p>
      <p class="font-semibold">{{ user.telephone }}</p>
    </div>

    <div class="bg-white p-5 rounded-xl shadow">
      <p class="text-sm text-gray-500">Conversions</p>
      <p class="text-xl font-bold text-gray-900">
        {{ conversions|length }}
      </p>
    </div>

    <div class="bg-white p-5 rounded-xl shadow">
      <p class="text-sm text-gray-500">SÃ©curitÃ©</p>
      <p class="text-green-600 font-semibold">
        Compte actif âœ”
      </p>
    </div>

  </div>

  <!-- ======================================================
       ðŸ”„ HISTORIQUE DES CONVERSIONS
  ====================================================== -->
  <div class="bg-white rounded-xl shadow p-6">

    <div class="flex justify-between items-center mb-4">
      <h2 class="text-lg font-semibold text-gray-900">
        ðŸ’± ActivitÃ© rÃ©cente
      </h2>

      <a href="{{ url_for('convert.historique') }}"
         class="text-sm text-indigo-600 hover:underline">
        Voir tout
      </a>
    </div>

    {% if conversions %}
    <div class="overflow-x-auto">
      <table class="w-full text-sm">
        <thead class="text-gray-500 border-b">
          <tr>
            <th class="text-left py-2">Date</th>
            <th class="text-left">De â†’ Vers</th>
            <th class="text-right">Montant</th>
            <th class="text-left">TÃ©lÃ©phones</th>
            <th class="text-center">Statut</th>
          </tr>
        </thead>
        <tbody>
          {% for c in conversions %}
          <tr class="border-b hover:bg-gray-50">
            <td class="py-2 text-xs text-gray-500">
              {{ c.date_conversion.strftime('%d/%m/%Y %H:%M') }}
            </td>
            <td>
              {{ c.from_currency }} â†’ {{ c.to_currency }}
            </td>
            <td class="text-right font-semibold text-indigo-600">
              {{ c.montant_initial }} â†’ {{ c.montant_converti }}
            </td>
            <td class="text-xs">
              {{ c.sender_phone }} â†’ {{ c.receiver_phone }}
            </td>
            <td class="text-center">
              {% if c.statut == 'envoyÃ©e' %}
                <span class="bg-green-100 text-green-700 px-2 py-1 rounded-full text-xs">
                  EnvoyÃ©e
                </span>
              {% elif c.statut == 'Ã©chouÃ©e' %}
                <span class="bg-red-100 text-red-700 px-2 py-1 rounded-full text-xs">
                  Ã‰chouÃ©e
                </span>
              {% else %}
                <span class="bg-yellow-100 text-yellow-700 px-2 py-1 rounded-full text-xs">
                  En attente
                </span>
              {% endif %}
            </td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
    {% else %}
      <p class="text-gray-500 text-sm text-center py-6">
        Aucune conversion pour le moment.
      </p>
    {% endif %}
  </div>
  
  <div class="bg-yellow-50 p-4 rounded-lg">
    <p class="font-semibold">Besoin dâ€™aide ?</p>
    <a href="{{ url_for('support.index') }}" class="text-blue-600 underline">
       Contacter le support
    </a>
  </div>


  <!-- ======================================================
       ðŸšª ACTIONS DE COMPTE
  ====================================================== -->
  <div class="flex justify-end">
    <a href="{{ url_for('auth.deconnexion') }}"
       class="text-red-600 text-sm hover:underline">
      Se dÃ©connecter
    </a>
  </div>

</div>

{% endblock %}
